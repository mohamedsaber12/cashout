{% load i18n %}
{% load l10n %}

<div id="step-{{step}}" form_prefix="category">

    <form action="." method="post" id="step_{{step}}_form">

        {% csrf_token %}

        <table class="table" id="categoryform">
            {{ filecategoryform.management_form }}
            {% for form in filecategoryform.forms %}
            {% if forloop.first %}
            <thead>
                <tr>
                    {% for field in form.visible_fields %}
                    <th>{{ field.label|capfirst }}</th>
                    {% endfor %}
                </tr>
            </thead>

            {% endif %}
            {% endfor %}
            <tbody>

                {% for form in filecategoryform.forms %}

                <tr class="category_formset_row">
                    {% for field in form.visible_fields %}
                    <td id="category_{{field.name}}">
                        {# Include the hidden fields in the form #}
                        {% if forloop.first %}
                        {% for hidden in form.hidden_fields %}
                        {{ hidden }}
                        {% endfor %}
                        {% endif %}
                        {{ field.errors.as_ul }}
                        {{ field }}
                        <br>
                        <span class="error_span"></span>
                        {% if forloop.first %}
                        <p class="error_span" id="category_row_{{forloop.parentloop.counter0}}_error"></p>
                        {%endif%}
                    </td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>
        </table>

    </form>


    <!-- empty form -->

    <table id="category_empty_form" style="display: none">
        <tr class="category_formset_row">
            {% for field in filecategoryform.empty_form.visible_fields %}
            <td id="category_{{field.name}}">
                {# Include the hidden fields in the form #}
                {% if forloop.first %}
                {% for hidden in filecategoryform.empty_form.hidden_fields %}
                {{ hidden }}
                {% endfor %}
                {% endif %}
                {{ field.errors.as_ul }}
                {{ field }}
                <span class="error_span"></span>
                {% if forloop.first %}
                <p class="error_span" id="category_row_{{forloop.parentloop.counter0}}_error"></p>
                {%endif%}
            </td>
            {% endfor %}
        </tr>
    </table>
    <button id="add_category_btn" class="btn btn-success">{% trans 'Add format' %}</button>


</div>